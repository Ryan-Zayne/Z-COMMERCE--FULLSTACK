import{u as m,a as Q,e as O,b as E,c as q,n as R,s as w,f as b,g as S,w as x,Q as B}from"./suspense-D5blzfLH.js";import{B as _,r as c,z as v,aj as H}from"./index-BOJgmFrE.js";function k(a,y,D){var o,f,i,h,g;const s=_(),l=m(),u=Q(),e=s.defaultQueryOptions(a);(f=(o=s.getDefaultOptions().queries)==null?void 0:o._experimental_beforeQuery)==null||f.call(o,e),e._optimisticResults=l?"isRestoring":"optimistic",O(e),E(e,u),q(u);const d=!s.getQueryCache().get(e.queryHash),[r]=c.useState(()=>new y(s,e)),t=r.getOptimisticResult(e),p=!l&&a.subscribed!==!1;if(c.useSyncExternalStore(c.useCallback(n=>{const C=p?r.subscribe(v.batchCalls(n)):R;return r.updateResult(),C},[r,p]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),c.useEffect(()=>{r.setOptions(e)},[e,r]),w(e,t))throw b(e,r,u);if(S({result:t,errorResetBoundary:u,throwOnError:e.throwOnError,query:s.getQueryCache().get(e.queryHash),suspense:e.suspense}))throw t.error;if((h=(i=s.getDefaultOptions().queries)==null?void 0:i._experimental_afterQuery)==null||h.call(i,e,t),e.experimental_prefetchInRender&&!H&&x(t,l)){const n=d?b(e,r,u):(g=s.getQueryCache().get(e.queryHash))==null?void 0:g.promise;n==null||n.catch(R).finally(()=>{r.updateResult()})}return e.notifyOnChangeProps?t:r.trackResult(t)}function j(a,y){return k(a,B)}export{j as u};
