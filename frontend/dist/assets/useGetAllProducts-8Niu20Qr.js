import{y as Q,z as f,A as C,f as S,r as d,B as P,C as M,D as q}from"./index-BwfLVWqJ.js";import{Q as v,u as x,a as A,e as k,b as B,c as H,s as m,f as O,w as L,g as z}from"./suspense-d-BcEOpp.js";function R(s,t){const i=new Set(t);return s.filter(r=>!i.has(r))}function T(s,t,i){const r=s.slice(0);return r[t]=i,r}var D=class extends Q{#r;#e;#i;#n;#s;#t;#o;#u;#a=[];constructor(s,t,i){super(),this.#r=s,this.#n=i,this.#i=[],this.#s=[],this.#e=[],this.setQueries(t)}onSubscribe(){this.listeners.size===1&&this.#s.forEach(s=>{s.subscribe(t=>{this.#d(s,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#s.forEach(s=>{s.destroy()})}setQueries(s,t){this.#i=s,this.#n=t,f.batch(()=>{const i=this.#s,r=this.#l(this.#i);this.#a=r,r.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));const n=r.map(e=>e.observer),o=n.map(e=>e.getCurrentResult()),u=n.some((e,a)=>e!==i[a]);i.length===n.length&&!u||(this.#s=n,this.#e=o,this.hasListeners()&&(R(i,n).forEach(e=>{e.destroy()}),R(n,i).forEach(e=>{e.subscribe(a=>{this.#d(e,a)})}),this.#f()))})}getCurrentResult(){return this.#e}getQueries(){return this.#s.map(s=>s.getCurrentQuery())}getObservers(){return this.#s}getOptimisticResult(s,t){const i=this.#l(s),r=i.map(n=>n.observer.getOptimisticResult(n.defaultedQueryOptions));return[r,n=>this.#h(n??r,t),()=>this.#c(r,i)]}#c(s,t){return t.map((i,r)=>{const n=s[r];return i.defaultedQueryOptions.notifyOnChangeProps?n:i.observer.trackResult(n,o=>{t.forEach(u=>{u.observer.trackProp(o)})})})}#h(s,t){return t?((!this.#t||this.#e!==this.#u||t!==this.#o)&&(this.#o=t,this.#u=this.#e,this.#t=C(this.#t,t(s))),this.#t):s}#l(s){const t=new Map(this.#s.map(r=>[r.options.queryHash,r])),i=[];return s.forEach(r=>{const n=this.#r.defaultQueryOptions(r),o=t.get(n.queryHash);o?i.push({defaultedQueryOptions:n,observer:o}):i.push({defaultedQueryOptions:n,observer:new v(this.#r,n)})}),i}#d(s,t){const i=this.#s.indexOf(s);i!==-1&&(this.#e=T(this.#e,i,t),this.#f())}#f(){if(this.hasListeners()){const s=this.#t,t=this.#c(this.#e,this.#a),i=this.#h(t,this.#n?.combine);s!==i&&f.batch(()=>{this.listeners.forEach(r=>{r(this.#e)})})}}};function I({queries:s,...t},i){const r=S(),n=x(),o=A(),u=d.useMemo(()=>s.map(c=>{const l=r.defaultQueryOptions(c);return l._optimisticResults=n?"isRestoring":"optimistic",l}),[s,r,n]);u.forEach(c=>{k(c),B(c,o)}),H(o);const[e]=d.useState(()=>new D(r,u,t)),[a,w,E]=e.getOptimisticResult(u,t.combine),p=!n&&t.subscribed!==!1;d.useSyncExternalStore(d.useCallback(c=>p?e.subscribe(f.batchCalls(c)):P,[e,p]),()=>e.getCurrentResult(),()=>e.getCurrentResult()),d.useEffect(()=>{e.setQueries(u,t)},[u,t,e]);const y=a.some((c,l)=>m(u[l],c))?a.flatMap((c,l)=>{const h=u[l];if(h){const g=new v(r,h);if(m(h,c))return O(h,g,o);L(c,n)&&O(h,g,o)}return[]}):[];if(y.length>0)throw Promise.all(y);const b=a.find((c,l)=>{const h=u[l];return h&&z({result:c,errorResetBoundary:o,throwOnError:h.throwOnError,query:r.getQueryCache().get(h.queryHash),suspense:h.suspense})});if(b?.error)throw b.error;return w(E())}const K=()=>{const{data:s,isError:t,isPending:i}=I({combine:e=>({data:e.flatMap(a=>a.data),isError:e.some(a=>a.isError),isPending:e.some(a=>a.isPending)}),queries:M.map(e=>q(e))}),r=s.filter(e=>e?.category==="smartphones"),n=s.filter(e=>e?.category==="laptops"),o=[...s.filter(e=>e?.category==="motorcycle"),...s.filter(e=>e?.category==="automotive")],u=[...s.filter(e=>e?.category==="mens-watches"),...s.filter(e=>e?.category==="womens-watches")];return{allProductsArray:s,hotSalesProductsArray:n,isError:t,isPending:i,recentlyViewedProductsArray:r,vehiclesProductsArray:o,watchesProductsArray:u}};export{K as u};
