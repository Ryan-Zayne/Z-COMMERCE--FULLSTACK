import{r as a,j as e,I as q,k as H,J as A,E as G,F as _,L as V}from"./index-CtoIyiXC.js";import{M as W,u as $,P as B,a as Z,L as K}from"./proxy-B7ehE-TH.js";import{g as J,a as X,B as Q}from"./Button-CJczChup.js";import{z as c,u as Y,s as ee,f as o}from"./index-cYfZRptV.js";import{s as U}from"./index-BCrG-q5n.js";import{_ as re}from"./chunk-PZ5AY32C-DghNgBBa.js";import{c as z}from"./cn-BORkeZql.js";class te extends a.Component{getSnapshotBeforeUpdate(n){const r=this.props.childRef.current;if(r&&n.isPresent&&!this.props.isPresent){const i=r.offsetParent,d=i instanceof HTMLElement&&i.offsetWidth||0,s=this.props.sizeRef.current;s.height=r.offsetHeight||0,s.width=r.offsetWidth||0,s.top=r.offsetTop,s.left=r.offsetLeft,s.right=d-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function se({children:t,isPresent:n,anchorX:r}){const i=a.useId(),d=a.useRef(null),s=a.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=a.useContext(W);return a.useInsertionEffect(()=>{const{width:g,height:m,top:f,left:h,right:b}=s.current;if(n||!d.current||!g||!m)return;const l=r==="left"?`left: ${h}`:`right: ${b}`;d.current.dataset.motionPopId=i;const p=document.createElement("style");return u&&(p.nonce=u),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${m}px !important;
            ${l}px !important;
            top: ${f}px !important;
          }
        `),()=>{document.head.removeChild(p)}},[n]),e.jsx(te,{isPresent:n,childRef:d,sizeRef:s,children:a.cloneElement(t,{ref:d})})}const ne=({children:t,initial:n,isPresent:r,onExitComplete:i,custom:d,presenceAffectsLayout:s,mode:u,anchorX:g})=>{const m=$(oe),f=a.useId();let h=!0,b=a.useMemo(()=>(h=!1,{id:f,initial:n,isPresent:r,custom:d,onExitComplete:l=>{m.set(l,!0);for(const p of m.values())if(!p)return;i&&i()},register:l=>(m.set(l,!1),()=>m.delete(l))}),[r,m,i]);return s&&h&&(b={...b}),a.useMemo(()=>{m.forEach((l,p)=>m.set(p,!1))},[r]),a.useEffect(()=>{!r&&!m.size&&i&&i()},[r]),u==="popLayout"&&(t=e.jsx(se,{isPresent:r,anchorX:g,children:t})),e.jsx(B.Provider,{value:b,children:t})};function oe(){return new Map}function ie(t=!0){const n=a.useContext(B);if(n===null)return[!0,null];const{isPresent:r,onExitComplete:i,register:d}=n,s=a.useId();a.useEffect(()=>{if(t)return d(s)},[t]);const u=a.useCallback(()=>t&&i&&i(s),[s,i,t]);return!r&&i?[!1,u]:[!0]}const C=t=>t.key||"";function T(t){const n=[];return a.Children.forEach(t,r=>{a.isValidElement(r)&&n.push(r)}),n}const we=({children:t,custom:n,initial:r=!0,onExitComplete:i,presenceAffectsLayout:d=!0,mode:s="sync",propagate:u=!1,anchorX:g="left"})=>{const[m,f]=ie(u),h=a.useMemo(()=>T(t),[t]),b=u&&!m?[]:h.map(C),l=a.useRef(!0),p=a.useRef(h),w=$(()=>new Map),[P,R]=a.useState(h),[y,I]=a.useState(h);Z(()=>{l.current=!1,p.current=h;for(let j=0;j<y.length;j++){const x=C(y[j]);b.includes(x)?w.delete(x):w.get(x)!==!0&&w.set(x,!1)}},[y,b.length,b.join("-")]);const L=[];if(h!==P){let j=[...h];for(let x=0;x<y.length;x++){const E=y[x],F=C(E);b.includes(F)||(j.splice(x,0,E),L.push(E))}return s==="wait"&&L.length&&(j=L),I(T(j)),R(h),null}const{forceRender:N}=a.useContext(K);return e.jsx(e.Fragment,{children:y.map(j=>{const x=C(j),E=u&&!m?!1:h===y||b.includes(x),F=()=>{if(w.has(x))w.set(x,!0);else return;let k=!0;w.forEach(O=>{O||(k=!1)}),k&&(N==null||N(),I(p.current),u&&(f==null||f()),i&&i())};return e.jsx(ne,{isPresent:E,initial:!l.current||r?void 0:!1,custom:n,presenceAffectsLayout:d,mode:s,onExitComplete:E?void 0:F,anchorX:g,children:j},x)})})};var D=Symbol("condition-default");function ae(t){const{children:n,condition:r=D}=t,i=J(n,M,{errorMessage:"Only one <Switch.Default> component is allowed",throwOnMultipleSlotMatch:!0});return X(n,M).find(u=>r===D?u.props.when:u.props.when===r)??i}function ce(t){const{children:n,when:r}=t;return r?q(n)?n(r):n:null}function M({children:t}){return t}M.slotSymbol=Symbol("switch-default");var S={};re(S,{Default:()=>M,Match:()=>ce,Root:()=>ae});const le=c.object({acceptTerms:c.boolean().refine(t=>t,"Please accept the terms and conditions"),confirmPassword:c.string().min(1,"Password confirmation is required!"),email:c.string().email("Please enter a valid email!"),password:c.string().min(8,"Password must be at least 8 characters!"),username:c.string().min(3,"Username must be at least 3 characters!").max(30,"Username must not be more than 30 characters long").regex(/^(?!.*-[a-z])[A-Z]['a-z-]*(?:-[A-Z]['a-z-]*)*(?:'[A-Z]['a-z-]*)*$/,`
				Username must be in sentence case, and can include hyphen, and apostrophes.
				A hyphen MUST be followed by an uppercase letter.
				Examples include: "Ali", "Ade-Bright" or "Smith's".
				`)}).strict().refine(t=>t.password===t.confirmPassword,{message:"Passwords do not match!",path:["confirmPassword"]}),de=c.object({email:c.string().min(1,"Email is a required field"),password:c.string().min(1,"Password is a required field"),rememberMe:c.boolean().optional()}).strict();c.object({amount:c.number(),cartItems:c.array(c.object({id:c.string(),name:c.string(),price:c.number(),quantity:c.number()})),customerEmail:c.string().email(),customerId:c.string(),redirectURL:c.string().url({message:"Invalid redirect URL"}).optional()});const v={error:"border-b-error focus-within:border-b-error dark:focus-within:border-b-error"},ue=t=>Object.entries(t);function je(t){const{classNames:n,formVariant:r}=t,i=H(),d=Y({resolver:ee(r==="signup"?le:de)}),{control:s,handleSubmit:u,setError:g}=d,m=u(async f=>{var p;A({isActive:!0});const h=r==="signup"?"/auth/signup":"/auth/signin",{data:b,error:l}=await G(h,{body:f,method:"POST"});if(A({isActive:!1}),_(l)&&l.errorData.errors){const w=l.errorData.errors;g("root.serverError",{message:w.formErrors}),ue(w.fieldErrors).forEach(([P,R])=>{g(P,{message:R})});return}if(_(l)){const w=l.errorData;g("root.serverError",{message:w.message});return}if(l){g("root.caughtError",{message:l.message});return}if(!((p=b.data)!=null&&p.user.isEmailVerified)){i("/auth/verify-email");return}i("/")});return e.jsxs(o.Root,{methods:d,className:z(`mt-[2.5rem] flex flex-col gap-[1.8rem] [&_input]:text-[1.4rem] lg:[&_input]:text-[1.6rem]
				[&_label]:text-[1.2rem]`,n==null?void 0:n.form),onSubmit:f=>void m(f),children:[e.jsx(U.Root,{when:r==="signup",children:e.jsxs(o.Field,{control:s,name:"username",children:[e.jsx(o.Label,{children:"Username"}),e.jsx(o.Input,{classNames:{error:v.error,input:`min-h-[3.2rem] border-b-[2px] border-b-carousel-btn bg-transparent text-input
							focus-within:border-b-navbar dark:focus-within:border-b-carousel-dot`},type:"text"}),e.jsx(o.ErrorMessage,{control:s,className:"text-error",errorField:"username"})]})}),e.jsxs(o.Field,{control:s,name:"email",children:[e.jsx(o.Label,{children:"Email address"}),e.jsx(o.Input,{classNames:{error:v.error,input:`min-h-[3.2rem] border-b-[2px] border-b-carousel-btn bg-transparent text-input
						focus-within:border-b-navbar dark:focus-within:border-b-carousel-dot`},type:"email"}),e.jsx(o.ErrorMessage,{control:s,className:"text-error",errorField:"email"})]}),e.jsxs(o.Field,{className:"relative",control:s,name:"password",children:[e.jsx(o.Label,{children:"Password"}),e.jsx(o.Input,{classNames:{error:v.error,input:"min-h-[3.2rem]",inputGroup:`border-b-[2px] border-b-carousel-btn bg-transparent text-input
						focus-within:border-b-navbar dark:focus-within:border-b-carousel-dot`},type:"password"}),e.jsx(o.ErrorMessage,{control:s,className:"text-error",errorField:"password"})]}),e.jsx(U.Root,{when:r==="signup",children:e.jsxs(o.Field,{className:"relative",control:s,name:"confirmPassword",children:[e.jsx(o.Label,{children:"Confirm Password"}),e.jsx(o.Input,{classNames:{error:v.error,inputGroup:`min-h-[3.2rem] border-b-[2px] border-b-carousel-btn bg-transparent
							text-input focus-within:border-b-navbar dark:focus-within:border-b-carousel-dot`},type:"password"}),e.jsx(o.ErrorMessage,{control:s,className:"text-error",errorField:"confirmPassword"})]})}),e.jsx(o.ErrorMessage,{className:"mb-[-0.7rem] mt-[-1rem] text-error",errorField:"serverError",type:"root"}),e.jsx(o.ErrorMessage,{className:"mb-[-0.7rem] mt-[-1rem] text-error",errorField:"caughtError",type:"root"}),e.jsxs(o.Field,{className:"flex flex-row flex-wrap gap-x-[1rem] text-[1.3rem] text-input",control:s,name:r==="signup"?"acceptTerms":"rememberMe",children:[e.jsx(o.Input,{type:"checkbox"}),e.jsxs(S.Root,{children:[e.jsx(S.Match,{when:r==="signin",children:e.jsx(o.Label,{children:"Remember me"})}),e.jsxs(S.Match,{when:r==="signup",children:[e.jsx("div",{className:"flex",children:e.jsxs(o.Label,{children:["I agree to all",e.jsx(V,{className:"ml-[0.5rem] font-[500] underline hover:text-[hsl(214,89%,53%)]",to:"#terms",children:"Terms & Conditions"})]})}),e.jsx(o.ErrorMessage,{control:s,className:"text-error"})]})]})]}),e.jsx(o.SubscribeToFormState,{render:({isSubmitting:f})=>e.jsx(Q,{className:z("mt-[1.5rem] rounded-[1rem] text-[1.7rem] font-[600]",f&&"cursor-not-allowed brightness-[0.5]"),isLoading:f,disabled:f,theme:"secondary",type:"submit",children:r==="signin"?"Sign In":"Sign Up"})})]})}export{we as A,je as S};
